register_interfacecfg_nvdata("xmainrollstatus");register_interfacecfg_nvdata("xmaingroupsorder");if(typeof BOX_CONTAINER==="undefined"){var BOX_CONTAINER_ID="boxes"}var Box_Container;var Box_Order=get_box_order();var Boxes;var Collapsed_Boxes={};NVData.xmainrollstatus.split("|").forEach(function(i){var the_match=i.match(/^(.*)=0$/);if(the_match&&document.getElementById(the_match[1])){Collapsed_Boxes[the_match[1]]=true}});var Rolling_Boxes={};function rollbox(clicked_el,no_nvdata){var box_el=DOM.getAncestorByClassName(clicked_el,"itembox");var box_id=box_el.id;if(box_id in Rolling_Boxes)return;Rolling_Boxes[box_id]=true;var h_el=box_el.getElementsByClassName("group-header")[0];var exp_el=DOM.getNextSibling(h_el);var body_el=DOM.getNextSibling(h_el.parentNode);var was_originally_open=DOM.hasClass(exp_el,"box-collapse-control");if(box_id in Collapsed_Boxes){var fade=CPANEL.animate.fade_in(body_el);var slide=CPANEL.animate.slide_down(body_el,function(){fade.stop(true);delete Rolling_Boxes[box_id]});delete Collapsed_Boxes[box_id]}else{var fade=CPANEL.animate.fade_out(body_el);var slide=CPANEL.animate.slide_up(body_el,function(){fade.stop(true);DOM.addClass(h_el,"no_bottom_border");delete Rolling_Boxes[box_id]});Collapsed_Boxes[box_id]=true}if(!no_nvdata)setboxstatus()}function raw_set_box(box_el,to_expand){var h_el=box_el.getElementsByClassName("group-header")[0];var exp_el=DOM.getNextSibling(h_el);var body_el=DOM.getNextSibling(h_el.parentNode);if(to_expand){body_el.style.display="";DOM.removeClass(h_el,"no_bottom_border");DOM.replaceClass(exp_el,"box-expand-control","box-collapse-control")}else{body_el.style.display="none";DOM.addClass(h_el,"no_bottom_border");DOM.replaceClass(exp_el,"box-collapse-control","box-expand-control")}}function x3_DDItem(){x3_DDItem.superclass.constructor.apply(this,arguments)}YAHOO.extend(x3_DDItem,CPANEL.dragdrop.DDItem,{endDrag:function(){x3_DDItem.superclass.endDrag.apply(this,arguments);var new_order=get_box_order();if(new_order.toString()!==Box_Order.toString()){Box_Order=new_order;CPANEL.nvdata.set("xmaingroupsorder",Box_Order.join("|"))}}});function init_boxes(){for(var id in Collapsed_Boxes){raw_set_box(document.getElementById(id),false)}Box_Container=document.getElementById(BOX_CONTAINER_ID);if(!Box_Container)return;var dd=CPANEL.dragdrop.containers(Box_Container,undefined,{item_constructor:x3_DDItem,dragElId:"menu_drag_el",placeholder:"drag_placeholder",animation_proxy_class:"anim_proxy"});for(var i=0;i<dd.items.length;i++){var cur_item=dd.items[i];var item_body_el=DOM.get(cur_item.getEl().id+"-body");DOM.addClass(item_body_el,"cellbox-body");dd.items[i].addInvalidHandleClass("cellbox-body")}}function get_box_order(){return DOM.getElementsByClassName("itembox","div",Box_Container).map(function(el){return el.id})}function restoreboxes(){for(var id in Collapsed_Boxes){raw_set_box(document.getElementById(id),false)}}function tempexpandboxes(){for(var id in Collapsed_Boxes){raw_set_box(document.getElementById(id),true)}}function setboxstatus(){var collapsed_list_txt=CPANEL.util.keys(Collapsed_Boxes).map(function(c){return c+"=0"}).join("|");CPANEL.nvdata.set("xmainrollstatus",collapsed_list_txt)}function showorder(){alert("The order now is: "+Box_Order.join(" ")+".")}function reload_this_page(){var rrnum=Math.floor(Math.random()*11111111);var href=window.location.href.replace(/[&?]keyid=[^=]*/,"");href+=href.indexOf("?")!==-1?"&":"?";href+="keyid="+rrnum;window.location.href=href}YAHOO.util.Event.onDOMReady(init_boxes);var build_progress_bar=function(el){var percent_el=YAHOO.util.Dom.getElementsByClassName("cpanel_widget_progress_bar_percent","div",el);for(var i in percent_el){if(percent_el.hasOwnProperty(i)){var elt=percent_el[i];if("innerHTML"in elt){var percent=YAHOO.lang.trim(elt.innerHTML);if(CPANEL.validate.positive_integer(percent)){CPANEL.widgets.progress_bar(el,percent,"",'{"inverse_colors":"true"}')}}}}};var build_progress_bars=function(root_el){YAHOO.util.Dom.getElementsByClassName("stats_progress_bar","div",root_el,build_progress_bar)};var destroy_progress_bars=function(root_el){YAHOO.util.Dom.getElementsByClassName("cpanel_widget_progress_bar","div",root_el,function(el){YAHOO.util.Dom.get(el).innerHTML=""})};var fetch_extended_stats=function(){YAHOO.util.Dom.setStyle("toggle_extended_stats","display","none");YAHOO.util.Dom.setStyle("extended_stats_loading_icon","display","block");YAHOO.util.Dom.get("extended_stats_loading_icon").innerHTML=CPANEL.icons.ajax+" loading...";var callback={success:function(o){YAHOO.util.Dom.get("extended_stats").innerHTML=o.responseText;build_progress_bars("stats_extended");expand_extended_stats()},failure:function(o){YAHOO.util.Dom.get("extended_stats_loading_icon").innerHTML="";YAHOO.util.Dom.setStyle("toggle_extended_stats","display","block");YAHOO.util.Dom.get("toggle_extended_stats").innerHTML="AJAX Failure: click to try again"},timeout:3e3};YAHOO.util.Connect.asyncRequest("GET","home/retro/extended_statsbar.html?secpolicy_ui=no",callback,null)};var finish_expand_extended_stats=function(){if(YAHOO.env.ua.ie>5&&YAHOO.env.ua.ie<8){build_progress_bars("stats_extended")}YAHOO.util.Dom.get("toggle_extended_stats").innerHTML="Collapse Stats";YAHOO.util.Dom.setStyle("toggle_extended_stats","display","");YAHOO.util.Dom.setStyle("extended_stats_loading_icon","display","none");YAHOO.util.Dom.replaceClass("toggle_extended_stats_img","box-expand-control","box-collapse-control");YAHOO.util.Dom.setStyle("extended_stats","height","100%");YAHOO.util.Dom.get("extended_stats_state").innerHTML="shown"};var expand_extended_stats=function(){YAHOO.util.Dom.get("extended_stats_state").innerHTML="animating";YAHOO.util.Dom.get("toggle_extended_stats").innerHTML="";var auto_height=CPANEL.animate.getAutoHeight("extended_stats");YAHOO.util.Dom.setStyle("extended_stats","height","0px");YAHOO.util.Dom.setStyle("extended_stats","display","block");var attributes={height:{to:auto_height,units:"px"}};var anim=new YAHOO.util.Anim("extended_stats",attributes,"0.5",YAHOO.util.Easing.easeOutStrong);anim.onComplete.subscribe(finish_expand_extended_stats);anim.animate()};var finish_hide_extended_stats=function(){YAHOO.util.Dom.get("toggle_extended_stats").innerHTML="Expand Stats";YAHOO.util.Dom.replaceClass("toggle_extended_stats_img","box-collapse-control","box-expand-control");YAHOO.util.Dom.get("extended_stats_state").innerHTML="hidden"};var hide_extended_stats=function(){if(YAHOO.env.ua.ie>5&&YAHOO.env.ua.ie<8){destroy_progress_bars("extended_stats")}YAHOO.util.Dom.get("extended_stats_state").innerHTML="animating";YAHOO.util.Dom.get("toggle_extended_stats").innerHTML="";var attributes={height:{to:"0",units:"px"}};var anim=new YAHOO.util.Anim("extended_stats",attributes,"0.5",YAHOO.util.Easing.easeOutStrong);anim.onComplete.subscribe(finish_hide_extended_stats);anim.animate()};var toggle_extended_stats=function(){YAHOO.util.Dom.get("toggle_extended_stats").blur();var state=YAHOO.util.Dom.get("extended_stats_state").innerHTML;state=YAHOO.lang.trim(state);if(state=="hidden"){if(YAHOO.lang.trim(YAHOO.util.Dom.get("extended_stats").innerHTML)==""){fetch_extended_stats()}else{expand_extended_stats()}SetNvData("xstatscollapsed","expanded")}else if(state=="shown"){hide_extended_stats();SetNvData("xstatscollapsed","collapsed")}};var init_extended_stats=function(){YAHOO.util.Event.on("toggle_extended_stats","click",function(e){YAHOO.util.Event.preventDefault(e)});YAHOO.util.Event.on(["toggle_extended_stats","stats-header"],"click",toggle_extended_stats);build_progress_bars("content-stats");register_interfacecfg_nvdata("xstatscollapsed");if(NVData["xstatscollapsed"]=="expanded"&&YAHOO.lang.trim(YAHOO.util.Dom.get("extended_stats").innerHTML)==""){fetch_extended_stats()}};register_interfacecfg_nvdata("x3finder");function collapse(){}var idgen=0;var ElementTextCache={};var tblParentCache={};var JumpEl;var jumpcount=0;var insearch=0;function searchpage(searchBoxEl){var searchText=searchBoxEl.value.toLowerCase();var rootSearchElement=document.getElementById("boxes");if(!rootSearchElement){rootSearchElement=document.getElementById("x")}var liEls=rootSearchElement.getElementsByTagName("div");var matchCount=0;var allParentUls={};var matchedParentUls={};var matchEl;if(!insearch){tempexpandboxes();insearch=1;if(NVData["x3finder"]!="off"){SetNvData("x3finder","off")}}if(!searchText){restoreboxes();insearch=0;document.getElementById("clearlnk").style.display="none"}for(var i=0;i<liEls.length;i++){if(YAHOO.util.Dom.hasClass(liEls[i],"item")==false)continue;var innerText;if(!ElementTextCache[liEls[i].id]||ElementTextCache[liEls[i].id]==""){innerText=liEls[i].innerHTML.replace(/\<[^\>]+\>/g,"").toLowerCase();var additional_search_text="";var additional_search_text_el=YAHOO.util.Dom.getFirstChildBy(liEls[i],function(e){return YAHOO.util.Dom.hasClass(e,"additional_search_text")});if(additional_search_text_el==true){additional_search_text=additional_search_text_el.innerHTML}innerText+=" "+additional_search_text;ElementTextCache[liEls[i].id]=innerText}else{innerText=ElementTextCache[liEls[i].id]}var tblParent=getTblParent(liEls[i]);if(innerText.match(searchText)){matchEl=liEls[i];matchCount++;YAHOO.util.Dom.removeClass(liEls[i],"searchhide");matchedParentUls[tblParent.id]=1;allParentUls[tblParent.id]=tblParent}else{allParentUls[tblParent.id]=tblParent;YAHOO.util.Dom.addClass(liEls[i],"searchhide")}}if(matchCount==0){document.getElementById("gosearch").style.display=""}else{document.getElementById("gosearch").style.display="none"}if(searchText){document.getElementById("clearlnk").style.display=""}for(var i in allParentUls){if(matchedParentUls[i]){YAHOO.util.Dom.removeClass(allParentUls[i],"searchhide")}else{YAHOO.util.Dom.addClass(allParentUls[i],"searchhide")}}}function getTblParent(tagEl){if(!tagEl.id){tagEl.id="idgen"+idgen++}if(tblParentCache[tagEl.id]){return tblParentCache[tagEl.id]}var thisEl=tagEl;while((thisEl.tagName!="DIV"||!YAHOO.util.Dom.hasClass(thisEl,"itembox"))&&thisEl.parentNode){thisEl=thisEl.parentNode}tblParentCache[tagEl.id]=thisEl;return thisEl}function clearsearch(){var quickJumpEl=document.getElementById("quickjump");quickJumpEl.value="";searchpage(quickJumpEl);restoreboxes();insearch=0}YAHOO.util.Event.onDOMReady(clearsearch);function gosearch(){var lnkEls=jumpEl.getElementsByTagName("a");if(!lnkEls[0].name){lnkEls[0].name="jump"+jumpcount++}window.location.href="#"+lnkEls[0].name}function focus_quickjump(){var quickJumpEl=document.getElementById("quickjump");if(quickJumpEl.offsetHeight!==0||quickJumpEl.offsetWidth!==0){quickJumpEl.focus()}}YAHOO.util.Event.onDOMReady(focus_quickjump);function hide_notices_ifempty(){var noticeboard=document.getElementById("noticeboard");if(!noticeboard)return;if(!/[^\s\n\r]/.test(noticeboard.innerHTML)){document.getElementById("notices").style.display="none"}}function load_main_page_warnings_success(o){var main_page_warnings_El=document.getElementById("main_page_warnings");main_page_warnings_El.innerHTML=o.responseText;hide_notices_ifempty()}function load_main_page_warnings_failure(o){var main_page_warnings_El=document.getElementById("main_page_warnings");main_page_warnings_El.innerHTML="&nbsp;";hide_notices_ifempty()}function load_main_page_warnings(){var main_page_warnings_El=document.getElementById("main_page_warnings");if(main_page_warnings_El){main_page_warnings_El.innerHTML=CPANEL.icons.ajax;var callback={success:load_main_page_warnings_success,failure:load_main_page_warnings_failure};YAHOO.util.Connect.asyncRequest("GET",CPANEL.security_token+"/frontend/"+window.thisTheme+"/home/retro/main_page_warnings.html.tt",callback)}else{hide_notices_ifempty()}}YAHOO.util.Event.onDOMReady(load_main_page_warnings);