define(["angular","cjt/util/test"],function(angular,TEST){var app=angular.module("App");app.controller("serviceConfigController",["$scope","$attrs",function($scope,$attrs){$scope.needsConflictResolution=function(){return $scope.hasConflict()&&!$scope.isResolved()};$scope.hasConflict=function(){return $scope.service&&$scope.service.isCandidate};$scope.isResolved=function(){return $scope.service.willLink||$scope.service.willDismiss};$scope.hasLinkAction=function(){return!!$attrs.linkAction};$scope.setDismiss=function(){$scope.service.willDismiss=true;$scope.service.enabled=false;$scope.validateConflictResolution()};$scope.setLink=function(){$scope.service.willLink=true;$scope.service.enabled=true;$scope.validateConflictResolution()};$scope.clearConflictResolution=function(){$scope.service.willLink=$scope.service.willDismiss=false;$scope.validateConflictResolution()};$scope.runLinkAction=function(){$scope.isLinking=true;$scope.setLink();if(!$scope.hasLinkAction()){$scope.isLinking=false;return}var ret=$scope.linkAction({service:$scope.service});if(TEST.isQPromise(ret)){ret.finally(function(){$scope.isLinking=false})}else{$scope.isLinking=false}return ret};$scope.validateConflictResolution=function(){if($scope.conflictResolutionRequired){$scope.ngModel.$setValidity("conflictCleared",!$scope.needsConflictResolution())}};$scope.toggleConflictSummary=function(){$scope.isSummaryCollapsed=!$scope.isSummaryCollapsed};$scope.isSummaryCollapsed=true}])});